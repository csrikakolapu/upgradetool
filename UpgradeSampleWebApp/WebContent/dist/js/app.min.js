var reportsTool=angular.module("reportsTool",["ngRoute","ngAnimate","ngCookies","ngSanitize","ngTouch","nvd3","floatThead"]);reportsTool.config(function(e,t,r){r.aHrefSanitizationWhitelist(/^\s*(https?|ftp|mailto|chrome-extension):/),e.when("/home",{templateUrl:"../partials/dashboard.html"}).when("/impact",{templateUrl:"../partials/impactAnalysis.html"}).when("/sFour",{templateUrl:"../partials/s4Hana.html"}).when("/bpview",{templateUrl:"../partials/businessProcess.html",controller:"bpController"}).when("/inventory",{templateUrl:"../partials/inventory.html"}).otherwise({redirectTo:"/home"}),t.html5Mode(!0)}),reportsTool.config(function(e){e.interceptors.push("httpInterceptor")}),reportsTool.factory("httpInterceptor",["$q","$rootScope",function(e,t){var r=[];return{request:function(o){return r.push(o.url),t.showLoader=!0,o||e.when(o)},response:function(o){var n=r.indexOf(o.config.url);return n>-1&&r.splice(n,1),0===r.length&&(t.showLoader=!1),o||e.when(o)},responseError:function(o){return 0===r.length&&(t.showLoader=!1),e.reject(o)}}}]),reportsTool.controller("LandingPageController",["$scope",function(e){d3.select(".nv-legendWrap").attr("transform","translate(200,10)"),console.log(d3.select(".nv-legendWrap .nv-series"))}]);
reportsTool.controller("bpController",["$scope","s4TabService","chartCreationService",function(a,t,e){a.selected="summary",a.bpCount=0,a.fioriCount=0,a.floatTheadOptions={scrollContainer:function(a){return a.closest(".tabular-data")}},a.bpCharts={view1:"piechart",view2:"donutchart",piechart:{options:e.createPieChartData(),data:[]},complexity:{options:e.createBarChartData(),data:[{key:"complexity",values:[]}]},migration:{options:e.createBarChartData(),data:[{key:"Migration",values:[]}]}},a.fioriData=[],0==a.bpCharts.piechart.data.length&&t.getData(getFileName("BP_COUNT_BY_OBJECT")).then(function(t){for(a.bpCharts.piechart.data=t,i=0;i<t.length;i++)a.bpCount+=parseInt(t[i].y)}),a.$watch("bpCharts.view2",function(e){if("COMPLEXITY"===e){if(0==a.bpCharts.complexity.data[0].values.length){var i="BP_COUNT_BY_OBJECT_"+e;t.getData(getFileName(i)).then(function(t){a.bpCharts.complexity.data[0].values=t})}}else if("MIGRATION"===e&&0==a.bpCharts.migration.data[0].values.length){var i="BP_COUNT_BY_OBJECT_"+e;t.getData(getFileName(i)).then(function(t){a.bpCharts.migration.data[0].values=t})}console.log(a.bpCharts)}),a.fioriCharts={view:"barchart",barchart:{options:e.createBarChartData(),data:[{key:"Cumulative Return",values:[]}]}},0==a.fioriCharts.barchart.data[0].values.length&&t.getData(getFileName("FIROIE_COUNT_BY_OBJECT_BAR")).then(function(t){for(a.fioriCharts.barchart.data[0].values=t,i=0;i<t.length;i++)a.fioriCount+=parseInt(t[i].y)}),0==a.fioriData.length&&t.getData(getFileName("Fiorie_data")).then(function(t){a.fioriData=t})}]);
reportsTool.factory("chartCreationService",["s4TabService",function(t){var e={};return e.createPieChartData=function(t){var e={chart:{type:"pieChart",height:300,x:function(t){return t.key},y:function(t){return t.y},showLabels:!1,duration:500,labelThreshold:.01,labelSunbeamLayout:!0,legend:{margin:{top:5,right:0,bottom:5,left:0}},legendPosition:"right"}};return e},e.createLineChartData=function(t){for(var e={chart:{type:"lineChart",margin:300,showLabels:!1,useInteractiveGuideline:!0,transitionDuration:350,labelThreshold:.01,labelSunbeamLayout:!0,legend:{margin:{top:5,right:0,bottom:5,left:100}},legendPosition:"right"}},a=[],r=[],i=0;i<100;i++)a.push({x:i,y:Math.sin(i/10)}),r.push({x:i,y:.5*Math.cos(i/10)});var t=[{values:a,key:"Sine Wave",color:"#ff7f0e"},{values:r,key:"Cosine Wave",color:"#2ca02c"}];return[e,t]},e.createDonutChartData=function(t){var e={chart:{type:"pieChart",height:300,x:function(t){return t.key},y:function(t){return t.y},showLabels:!1,duration:500,labelThreshold:.01,labelSunbeamLayout:!0,legend:{margin:{top:5,right:35,bottom:5,left:0}},donut:!0,donutRatio:.35,legendPosition:"right"}};return e},e.createBubbleChartData=function(){var t={chart:{type:"scatterChart",height:300,width:300,showLabels:!1,duration:500,showDistX:!0,showDistY:!0,forceX:[0,100],forceY:[0,100],color:d3.scale.category10().range(),xAxis:{axisLabel:"X Axis",axisLabelDistance:5},yAxis:{axisLabel:"Y Axis",axisLabelDistance:5},pointRange:[100,100],legendPosition:"right"}};return t},e.createBarChartData=function(){var t={chart:{type:"discreteBarChart",height:260,showValues:!0,duration:500,staggerLabels:!0,xAxis:{axisLabel:"X Axis",rotateLabels:-45,extraBottomOffset:10},yAxis:{axisLabel:"Y Axis",axisLabelDistance:5},legendPosition:"right"}};return t},e}]);
reportsTool.directive("toggleTable",["$injector",function(e){return{restrict:"C",scope:{showTable:"=",scrollDown:"=",tabularData:"=",tabularHeader:"="},link:function(r,t,a){var o;a.fileService&&(o=e.get([a.fileService])),t.on("click",function(e){r.tabularData||void 0==o||o.getData(getFileName(a.fileName)).then(function(e){r.tabularHeader=e[0],e.splice(0,1),r.tabularData=e}),r.$apply(function(){r.showTable=!r.showTable,r.scrollDown=!r.scrollDown})})}}}]),reportsTool.directive("tableGenerate",[function(){return{restrict:"E",scope:{tableHeader:"=",tabularData:"="},templateUrl:"table.html",controller:function(e,r){e.reverseSort=!1,e.searchText="",e.searchCategory="",e.orderByField="";for(var t in e.tabularData[0]){e.searchCategory=t;break}e.sortFunction=function(r){e.orderByField=r,e.reverseSort=!e.reverseSort},e.floatTheadOptions={scrollContainer:function(e){return e.closest(".center-section")}},e.filterFunction=function(r){var t=r[e.searchCategory].toLowerCase();return t.indexOf(e.searchText.toLowerCase())>-1}},link:function(e,r,t){}}}]);
reportsTool.controller("ImpactController",["$scope","s4TabService","chartCreationService",function(t,e,a){function r(){t.defectFilter="COMPLEXITY",t.defectsCharts={view1:"piechart",view2:"donutchart",piechart:{options:a.createPieChartData(),data:[]},linechart:{options:a.createLineChartData()[0],data:a.createLineChartData()[1]},donutchart:{options:a.createDonutChartData(),data:[]}},0==t.IncompabilitycountsArray.length&&e.getData(getFileName("defects_BY_count")).then(function(e){t.IncompabilitycountsArray=e}),0==t.defectsCharts.piechart.data.length&&e.getData(getFileName("defects_BY_COMPTYPE")).then(function(e){t.defectsCharts.piechart.data=e}),0==t.defectsCharts.donutchart.data.length&&e.getData(getFileName("defects_BY_COMPTYPE_COMPLEXITY")).then(function(e){t.defectsCharts.donutchart.data=o(e,"","COMPLEXITY")}),t.defectsCharts.piechart.options.chart.callback=function(a){a.pie.dispatch.on("elementClick",function(a){var r="defects_BY_COMPTYPE_"+t.defectFilter;e.getData(getFileName(r)).then(function(e){t.defectsCharts.donutchart.data=o(e,a.data.key,t.defectFilter)})})}}function n(){t.defectFilter="COMPLEXITY",e.getData(getFileName("Performance_defects_BY_count")).then(function(e){t.performanceCountsArray=e}),t.performanceCharts={view1:"piechart",view2:"donutchart",callBackCheck:!1,piechart:{options:a.createPieChartData(!1),data:[]},linechart:{options:a.createLineChartData(!1),data:[]},donutchart:{options:a.createDonutChartData(!1),data:[]}},0==t.performanceCharts.piechart.data.length&&e.getData(getFileName("defects_BY_COMPTYPE")).then(function(e){t.performanceCharts.piechart.data=e}),0==t.performanceCharts.donutchart.data.length&&e.getData(getFileName("defects_BY_COMPTYPE_COMPLEXITY")).then(function(e){t.performanceCharts.donutchart.data=o(e,"","COMPLEXITY")}),0==t.performanceCharts.linechart.data.length&&e.getData(getFileName("defects_BY_COMPTYPE_COMPLEXITY")).then(function(e){t.performanceCharts.linechart.data=e}),t.performanceCharts.piechart.options.chart.callback=function(a){a.pie.dispatch.on("elementClick",function(a){var r="defects_BY_COMPTYPE_"+t.defectFilter;e.getData(getFileName(r)).then(function(e){t.performanceCharts.donutchart.data=o(e,a.data.key,t.defectFilter)})})}}function c(){e.getData(getFileName("Usage_defects_BY_count")).then(function(e){t.usageCountsArray=e}),t.usageCharts={view1:"piechart",view2:"donutchart",piechart:{options:a.createPieChartData(!1),data:[]},linechart:{options:a.createLineChartData(!1),data:[]},donutchart:{options:a.createDonutChartData(!1),data:[]}},t.usageCharts.piechart.options.chart.callback=function(a){a.pie.dispatch.on("elementClick",function(a){e.getData(getFileName("defects_BY_COMPTYPE")).then(function(e){t.usageCharts.donutchart.data=e})})},e.getData(getFileName("defects_BY_COMPTYPE")).then(function(e){t.usageCharts.piechart.data=e}),e.getData(getFileName("defects_BY_COMPTYPE")).then(function(e){t.usageCharts.linechart.options=e}),e.getData(getFileName("defects_BY_COMPTYPE_COMPLEXITY")).then(function(e){t.usageCharts.donutchart.data=o(e,"","COMPLEXITY")})}function o(e,a,r){var n=[],c=t.typeArray[r];if(""===a)for(var o=0;o<c.length;o++){for(var i=0,h=0;h<e.length;h++)i+=parseInt(e[h][c[o]]);n.push({key:c[o],y:i})}else{for(var s={},h=0;h<e.length;h++)if(a==e[h].compType){s=e[h];break}for(var o=0;o<c.length;o++)n.push({key:c[o],y:s[c[o]]})}return n}t.selected="defects",t.orderByField="name",t.reverseSort=!1,t.showTable=!1,t.scrolDown=!1,t.tabularData=[],t.IncompabilitycountsArray=[],t.performanceCountsArray=[],t.usageCountsArray=[],t.typeArray=[],t.typeArray.COMPLEXITY=["High","Medium","Low"],t.typeArray.SEVERITY=["Warning","MustFix","Suggestive"],t.typeArray.ERROR=["Obsolete","Syntax","Unicode","SecondaryIndex","Pool/ClusterTable","ALV"],t.floatTheadOptions={scrollContainer:function(t){return t.closest(".tabular-data")}},0==t.tabularData.length&&e.getData(getFileName("DEF_ECC_PROG_20140716_182107")).then(function(e){t.tabularData=e}),t.$watch("selected",function(t,e){switch(t){case"defects":r();break;case"performance":n();break;case"usage":c();break;default:r()}}),t.updateChartType=function(a,r){t.defectFilter=a,t.defectsCharts.view2="donutchart";var n="defects_BY_COMPTYPE_"+a;e.getData(getFileName(n)).then(function(e){t.defectsCharts.donutchart.data=o(e,"",a)})}}]);
reportsTool.controller("inventoryController",["$scope","getFileContent",function(t,e){t.chart={view1:"pieChart",view2:"donutchart"},t.floatTheadOptions={scrollContainer:function(t){return t.closest(".tabular-data")}},e.getData(getFileName("INV_OBJ_SUMMARY")).then(function(e){t.objSummary=e,t.defaultObjType=t.objSummary[0].OBJTYPE,t.objTypeDataFile="INV_"+t.defaultObjType+"_DATA",n(t.defaultObjType)});var n=function(n){var o="INV_"+n+"_SUMMARY";e.getData(getFileName(o)).then(function(e){t.subObjSummary=e}),a(n)},a=function(n){var a="INV_"+n+"_DATA";e.getData(getFileName(a)).then(function(e){t.objTypeHeader=e[0],e.splice(0,1),t.objTypeData=e})};t.pieOptions={chart:{type:"pieChart",height:300,x:function(t){return t.key},y:function(t){return t.value},showLabels:!1,duration:500,labelThreshold:.01,labelSunbeamLayout:!0,legend:{margin:{top:5,right:35,bottom:5,left:0}},callback:function(t){t.pie.dispatch.on("elementClick",function(t){n(t.data.OBJTYPE)})},legendPosition:"right"}},t.donutOptions={chart:{type:"pieChart",height:300,x:function(t){return t.key},y:function(t){return t.value},showLabels:!1,duration:500,labelThreshold:.01,labelSunbeamLayout:!0,legend:{margin:{top:5,right:35,bottom:5,left:0}},donut:!0,donutRatio:.35,legendPosition:"right"}}}]);
console.log("Hello World from Main Javascript"),console.log("Hello World from Main Javascript 12"),console.log("Hello World from Main min 12"),console.log("Hello World from browser sync");
reportsTool.controller("navController",["$scope","$location",function(n,e){n.getClass=function(n){return e.path().substr(0,n.length)===n?"active":""},n.navItems=[{description:"System Overview",linkCode:"/home",iconName:"dashboard"},{description:"Inventory",linkCode:"/inventory",iconName:"university"},{description:"Impact Ananlysis",linkCode:"/impact",iconName:"bar-chart"},{description:"S/4Hana",linkCode:"/sFour",iconName:"mixcloud"},{description:"Business Process",linkCode:"/bpview",iconName:"tasks"}]}]);
reportsTool.controller("s4Controller",["$scope","getFileContent",function(t,e){t.selected="busFunctions",t.chart={view1:"pieChart",view2:"pieChart"},t.floatTheadOptions={scrollContainer:function(t){return t.closest(".tabular-data")}},e.getData(getFileName("S4HANA_COUNT_SUMMARY")).then(function(e){t.countSummary=e}),e.getData(getFileName("S4HANA_BF_BY_CATEGORY")).then(function(e){t.uniqueBFuncCateg=e}),e.getData(getFileName("S4HANA_BF_BY_COMPTYPE")).then(function(e){t.uniqueBFuncCompType=e}),t.options={chart:{type:"pieChart",height:300,x:function(t){return t.key},y:function(t){return t.value},showLabels:!1,duration:500,labelThreshold:.01,labelSunbeamLayout:!0,legend:{margin:{top:5,right:35,bottom:5,left:0}},legendPosition:"right"}}}]);
reportsTool.factory("s4TabService",["$http","$q",function(e,t){var r={};return r.getData=function(e){var r=t.defer(),o=getFileContent("data/"+e);return r.resolve(o),r.promise},r}]);
function getFileContent(e,t){for(var n=fs.readFileSync(e,"utf8",function(e,t){}),o=n.split("\n"),a=!0,i=null,r=[],s=0;s<o.length;s++){var p=o[s];if("#"!=p.trim().charAt(0))if(a)i=p.split("\t"),a=!1;else{var c=p.split("\t");if(1!=c.length){for(var l={},y=0;y<i.length;y++){var d=i[y];l[$.trim(d)]=$.trim(c[y])}r.push(l)}}}return r}function writeFile(){jQuery("#ajax_loader").show();var e=excelbuilder.createWorkbook("./","Report.xlsx"),t=e.createSheet("sheet1",10,inventoryDownloadData[invDownloadKey].length+1);t.set(1,1,"Object Type"),t.set(2,1,"Object Type Description"),t.set(3,1,"Sub-Object Type"),t.set(4,1,"Sub-Object Description"),t.set(5,1,"Object Name"),t.set(6,1,"Object Description"),t.set(7,1,"Package"),t.set(8,1,"Application Area"),t.set(9,1,"Main Program"),t.set(10,1,"Include Name");for(var n=2;n<inventoryDownloadData[invDownloadKey].length+1;n++){var o=n-1;t.set(1,n,inventoryDownloadData[invDownloadKey][o][0]),t.set(2,n,inventoryDownloadData[invDownloadKey][o][1]),t.set(3,n,inventoryDownloadData[invDownloadKey][o][2]),t.set(4,n,inventoryDownloadData[invDownloadKey][o][3]),t.set(5,n,inventoryDownloadData[invDownloadKey][o][4]),t.set(6,n,inventoryDownloadData[invDownloadKey][o][5]),t.set(7,n,inventoryDownloadData[invDownloadKey][o][6]),t.set(8,n,inventoryDownloadData[invDownloadKey][o][7]),t.set(9,n,inventoryDownloadData[invDownloadKey][o][8]),t.set(10,n,inventoryDownloadData[invDownloadKey][o][9])}e.save(function(t){t?(jQuery("#ajax_loader").hide(),e.cancel()):(jQuery("#ajax_loader").hide(),alert("Workbook downloaded."))})}var fs=require("fs"),nodeExcel=require("excel-export"),inventoryDownloadData={},invDownloadKey="",express=require("express"),expressApp=express(),bodyParser=require("body-parser"),gui=require("nw.gui"),win=gui.Window.get();win.on("loading",function(){}),expressApp.use(bodyParser.json()),expressApp.post("/excelDownload",function(e,t){var n={};n.cols=[{caption:"Object Type",type:"string",beforeCellWrite:function(e,t){return t.toUpperCase()},width:28.7109375},{caption:"Object Type Description",type:"string"},{caption:"Sub-Object Type",type:"string"},{caption:"Sub-Object Description",type:"string"},{caption:"Object Name",type:"string"},{caption:"Object Description\t",type:"string"},{caption:"Package",type:"string"},{caption:"Application Area\t",type:"string"},{caption:"Main Program\t",type:"string"},{caption:"Include Name",type:"string"}],n.rows=new Array,n.rows=inventoryDownloadData[invDownloadKey],$("#ajax_loader").show();var o=nodeExcel.execute(n);t.setHeader("Content-Type","application/vnd.openxmlformats"),t.setHeader("Content-Disposition","attachment; filename=Report.xlsx"),t.end(o,"binary")}),expressApp.get("/excelDownload",function(e,t){var n={},n={};n.cols=[{caption:"Object Type",type:"string",beforeCellWrite:function(e,t){return t.toUpperCase()},width:28.7109375},{caption:"Object Type Description",type:"string"},{caption:"Sub-Object Type",type:"string"},{caption:"Sub-Object Description",type:"string"},{caption:"Object Name",type:"string"},{caption:"Object Description\t",type:"string"},{caption:"Package",type:"string"},{caption:"Application Area\t",type:"string"},{caption:"Main Program\t",type:"string"},{caption:"Include Name",type:"string"}],n.rows=new Array,n.rows=inventoryDownloadData[invDownloadKey];var o=nodeExcel.execute(n);t.setHeader("Content-Type","application/vnd.openxmlformats"),t.setHeader("Content-Disposition","attachment; filename=Report.xlsx"),t.end(o,"binary")}),console.log("Listening on port 3000");var excelbuilder=require("msexcel-builder");
reportsTool.factory("getFileContent",["$http","$q",function(t,e){var r={};return r.getData=function(t){var r=e.defer(),n=getFileContent("data/"+t);return r.resolve(n),r.promise},r}]);
function getFileName(t){var e=null;return $.each(mapTextFile,function(n,r){if(r.KEY==t)return e=r.VALUE,!1}),e}function findWhere(t,e,n){var r=null;return $.each(t,function(t,i){if(i[e]==n)return r=i,!1}),r}function getFileContent(t){console.log(t);for(var e=fs.readFileSync(t,"utf8",function(t,e){}),n=e.split("\n"),r=!0,i=null,l=[],a=0;a<n.length;a++){var o=n[a];if("#"!=o.trim().charAt(0))if(r)i=o.split("\t"),r=!1;else{var f=o.split("\t");if(1!=f.length){for(var u={},c=0;c<i.length;c++){var s=i[c];u[s.trim()]=f[c].trim()}l.push(u)}}}return l}var mapTextFile,S4Data,mapTextFile=getFileContent("data/SAPUATProp.Properties"),getUrlParameter=function(t){var e,n,r=decodeURIComponent(window.location.search.substring(1)),i=r.split("&");for(n=0;n<i.length;n++)if(e=i[n].split("="),e[0]===t)return void 0===e[1]||e[1]};