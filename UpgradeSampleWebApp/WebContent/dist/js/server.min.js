function getFileContent(e,t){for(var n=fs.readFileSync(e,"utf8",function(e,t){}),o=n.split("\n"),a=!0,i=null,r=[],s=0;s<o.length;s++){var p=o[s];if("#"!=p.trim().charAt(0))if(a)i=p.split("\t"),a=!1;else{var c=p.split("\t");if(1!=c.length){for(var l={},y=0;y<i.length;y++){var d=i[y];l[$.trim(d)]=$.trim(c[y])}r.push(l)}}}return r}function writeFile(){jQuery("#ajax_loader").show();var e=excelbuilder.createWorkbook("./","Report.xlsx"),t=e.createSheet("sheet1",10,inventoryDownloadData[invDownloadKey].length+1);t.set(1,1,"Object Type"),t.set(2,1,"Object Type Description"),t.set(3,1,"Sub-Object Type"),t.set(4,1,"Sub-Object Description"),t.set(5,1,"Object Name"),t.set(6,1,"Object Description"),t.set(7,1,"Package"),t.set(8,1,"Application Area"),t.set(9,1,"Main Program"),t.set(10,1,"Include Name");for(var n=2;n<inventoryDownloadData[invDownloadKey].length+1;n++){var o=n-1;t.set(1,n,inventoryDownloadData[invDownloadKey][o][0]),t.set(2,n,inventoryDownloadData[invDownloadKey][o][1]),t.set(3,n,inventoryDownloadData[invDownloadKey][o][2]),t.set(4,n,inventoryDownloadData[invDownloadKey][o][3]),t.set(5,n,inventoryDownloadData[invDownloadKey][o][4]),t.set(6,n,inventoryDownloadData[invDownloadKey][o][5]),t.set(7,n,inventoryDownloadData[invDownloadKey][o][6]),t.set(8,n,inventoryDownloadData[invDownloadKey][o][7]),t.set(9,n,inventoryDownloadData[invDownloadKey][o][8]),t.set(10,n,inventoryDownloadData[invDownloadKey][o][9])}e.save(function(t){t?(jQuery("#ajax_loader").hide(),e.cancel()):(jQuery("#ajax_loader").hide(),alert("Workbook downloaded."))})}var fs=require("fs"),nodeExcel=require("excel-export"),inventoryDownloadData={},invDownloadKey="",express=require("express"),expressApp=express(),bodyParser=require("body-parser"),gui=require("nw.gui"),win=gui.Window.get();win.on("loading",function(){}),expressApp.use(bodyParser.json()),expressApp.post("/excelDownload",function(e,t){var n={};n.cols=[{caption:"Object Type",type:"string",beforeCellWrite:function(e,t){return t.toUpperCase()},width:28.7109375},{caption:"Object Type Description",type:"string"},{caption:"Sub-Object Type",type:"string"},{caption:"Sub-Object Description",type:"string"},{caption:"Object Name",type:"string"},{caption:"Object Description\t",type:"string"},{caption:"Package",type:"string"},{caption:"Application Area\t",type:"string"},{caption:"Main Program\t",type:"string"},{caption:"Include Name",type:"string"}],n.rows=new Array,n.rows=inventoryDownloadData[invDownloadKey],$("#ajax_loader").show();var o=nodeExcel.execute(n);t.setHeader("Content-Type","application/vnd.openxmlformats"),t.setHeader("Content-Disposition","attachment; filename=Report.xlsx"),t.end(o,"binary")}),expressApp.get("/excelDownload",function(e,t){var n={},n={};n.cols=[{caption:"Object Type",type:"string",beforeCellWrite:function(e,t){return t.toUpperCase()},width:28.7109375},{caption:"Object Type Description",type:"string"},{caption:"Sub-Object Type",type:"string"},{caption:"Sub-Object Description",type:"string"},{caption:"Object Name",type:"string"},{caption:"Object Description\t",type:"string"},{caption:"Package",type:"string"},{caption:"Application Area\t",type:"string"},{caption:"Main Program\t",type:"string"},{caption:"Include Name",type:"string"}],n.rows=new Array,n.rows=inventoryDownloadData[invDownloadKey];var o=nodeExcel.execute(n);t.setHeader("Content-Type","application/vnd.openxmlformats"),t.setHeader("Content-Disposition","attachment; filename=Report.xlsx"),t.end(o,"binary")}),console.log("Listening on port 3000");var excelbuilder=require("msexcel-builder");